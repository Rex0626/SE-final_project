<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>所有隊伍作品一覽</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
  <style>
    body { font-family: sans-serif; max-width: 1000px; margin: 2rem auto; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; vertical-align: top; }
    th { background: #ffffff; }
    a { color: #69503F; text-decoration: none; }
  </style>
</head>
<body>
  <header>
    <h1>所有隊伍作品一覽</h1>
  </header>
  
  <div id="content">
    <p>載入中⋯⋯</p>
  </div>

  <script>
    fetch('list_submissions.php')
      .then(r => r.json())
      .then(data => {
        const c = document.getElementById('content');
        if (!data.success) {
          c.innerHTML = `<p style="color:red">錯誤：${data.error}</p>`;
          return;
        }
        if (data.submissions.length === 0) {
          c.innerHTML = '<p>目前沒有任何作品提交。</p>';
          return;
        }
        let html = '<table><thead><tr>'
                 + '<th>隊伍名稱</th>'
                 + '<th>作品說明</th>'
                 + '<th>Poster</th>'
                 + '<th>Video</th>'
                 + '<th>Code</th>'
                 + '</tr></thead><tbody>';
        data.submissions.forEach(item => {
          const w = item.work;
          html += '<tr>';
          html += `<td>${item.TeamName}</td>`;
          if (w) {
            html += `<td>${w.Description || '—'}</td>`;
            html += `<td>${w.Poster 
                          ? `<a href="${w.Poster}" target="_blank">連結</a>` 
                          : '—'}</td>`;
            html += `<td>${w.VideoLink 
                          ? `<a href="${w.VideoLink}" target="_blank">連結</a>` 
                          : '—'}</td>`;
            html += `<td>${w.CodeLink 
                          ? `<a href="${w.CodeLink}" target="_blank">連結</a>` 
                          : '—'}</td>`;
          } else {
            html += '<td colspan="4" style="text-align:center;color:#888">尚未上傳作品</td>';
          }
          html += '</tr>';
        });
        html += '</tbody></table>';
        c.innerHTML = html;
      })
      .catch(err => {
        document.getElementById('content').innerHTML =
          `<p style="color:red">載入失敗：${err}</p>`;
      });
  </script>
</body>
</html>
